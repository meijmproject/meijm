var Xtable=(function(d,b){function h(i){i.preventDefault();event.stopPropagation();return false;}var e={el:"table.x-table",classes:{sortable:"sortable"},sort:{toggle:{"sorting":"sorting_asc","sorting_asc":"sorting_desc","sorting_desc":"sorting_asc"}},loading:"加载中",paginationType:"input",lengthMenuType:"select",lengthMenu:[30,50,100],checkbox:false,singleCheck:true,selectable:true,rowNumber:true,oClasses:{"sPageButton":"paginate_button","sPageFirst":"first","sPagePrevious":"previous","sPageNext":"next","sPageLast":"last"},language:{oPaginate:{"sFirst":"首页","sPrevious":"上一页","sNext":"下一页","sLast":"尾页"}},dom:'<".ct"t><".page_foot"lip>'};var g=function(k){this.settings=d.extend(true,{},e,k);this.dom=this.settings.dom;if(!this.settings.el){throw"no el parameter in settings.";}this.table=d(this.settings.el);if(!this.table.is("table")){this.wrap=d(this.settings.el);if(this.wrap.length==0){throw"cannot find el node.";}this.table=this.wrap.find("table:first");if(this.table.length==0){this.table=d("<table><thead></thead><tbody></tbody></table>");}}else{this.wrap=d('<div class="xtable-wrap"></div>').insertAfter(this.table);}this.loading=d('<div class="loading-mask" style="display: none;"><span class="loading"></span></div>').appendTo(this.wrap);new g.ux.DomExprParser().parse(this.dom,this.wrap,{"t":this.table});this.thead=this.table.find("thead");if(this.thead.length==0){this.thead=d("<thead></thead>").appendTo(this.table);}this.tbody=this.table.find("tbody");if(this.tbody.length==0){this.tbody=d("<tbody></tbody>").appendTo(this.table);}var l=this;if(this.table.data("sortable")){this.table.addClass(this.settings.classes.sortable);}this.sortable=this.table.hasClass(this.settings.classes.sortable);g.events.initialize(this);this.initThead();this.url=this.settings.url;this.store=new g.ux.Store({url:this.url,fields:this.fields});var m=[];this.tbody.find("tr").each(function(){var n={};d(this).children().each(function(o){n[l.columns[o]?l.columns[o].field:o]=d(this).html();});m.push(n);});this.settings.aData=m;this.tbody.children().remove();if(this.settings.loading!==false){this.store.on("beforeload",function(){this.loading.show();},this);this.on("draw",function(){this.loading.hide();},this);}this.store.on("sort",this.onSort,this);this.store.on("load",this.draw,this);this.plugins={};for(var j in g.plugins){c(this,g.plugins[j],j,"fnInit");}this.additives={};for(var i in g.additives){a(this,g.additives[i],i);}if(d.isFunction(this.settings.onRender)){this.settings.onRender.call(this);}this.fire("render",this);if(this.settings.defer===false){this.store.load({data:this.settings.aData,params:{start:this.page.start,limit:this.page.limit}});}};function a(l,k,i){var o=l.settings[k["_sProp"]];if(!o){return;}var m=k[o];var j=l.additives[i]={declare:k,instance:m};var n=m["fnInit"];if(n){n.call(l,l,j,m);}}function c(o,p,m,l){var j=o.settings[p["_sProp"]];if(!j){return;}var k=o.wrap.find(p["_sSelector"]||("."+p["_sCss"]));if(k.length==0){throw"not found "+p["_sSelector"]+" element in wrap.";}g.utils.apply(o,p["_oOverrides"]);var i=p[j];k.addClass(i.style||((p["_sCss"]||"")+"_"+j));var n=o.plugins[m]={node:k,declare:p,instance:i};var q=p["_fnInit"];if(q){q.call(o,k,o);}f(o,n,"fnInit");}function f(l,k,m){var j=k.declare["_"+m+"Before"];if(j){j.call(l,k.node,l,k.instance,k);}var i=k.instance[m];if(i){i.call(l,k.node,l,k.instance,k);}}d.extend(g.prototype,{initThead:function(){var p=[],l,q,o;var j=this.thead.find("tr:first").children();var r=j.length;var m=[];if(this.settings.columns&&this.settings.columns.length>0){var k;for(var n=0;n<this.settings.columns.length;n++){k=this.settings.columns[n];k.index=k.index!=undefined?k.index:n;k.index=k.index<0?k.index+r:k.index;m[k.index]=k;}}this.thead.children().remove();if(!m||m.length==0){throw"not set columns.";}this.columns=[];if(this.settings.rowNumber){this.columns.push(new g.ux.RowNumber(this));}if(this.settings.checkbox){this.columns.push(new g.ux.SelectModel(this,this.settings.singleCheck));}else{if(this.settings.selectable){new g.ux.SelectModel(this,this.settings.singleCheck);}}this.columns=this.columns.concat(m);this.defaultColumnWidth=80;j=d("<tr></tr>").appendTo(this.thead);for(var n=0;n<this.columns.length;n++){l=this.columns[n];q=l.field||n;l.field=q;this._renderHeader(j,l);p.push({name:q,type:l["type"]||"string",sort:l["sort"]});}this.fire("allheadersrender",this);this.fields=p;this.headers=this.thead.find("tr:first").children();},_renderHeader:function(k,i){var l=d("<th>"+(i.header||"")+"</th>");if(i.style){l.css(i.style);}var j=i.width?i.width:this.defaultColumnWidth;l.css({width:j});if(i.minWidth){l.css({minWidth:i.minWidth});}if(i.maxWidth){l.css({maxWidth:i.maxWidth});}if(i.type=="html"){i.sortable=false;}l.attr("data-field",i.field);l.bind("dragstart.xt",h);if(this.sortable&&i.sortable!==false){l.addClass("sorting");l.bind("click.xt",{name:i.field,that:this},this.onHeaderClick);}k.append(l);this.fire("headerrender",k,i);},onHeaderClick:function(j){var i=j.data.that;var m=d(this);var l=m.hasClass("sorting")?"sorting":m.hasClass("sorting_asc")?"sorting_asc":m.hasClass("sorting_desc")?"sorting_desc":null;if(l){var k=i.settings.sort.toggle[l];i.store.sort(j.data.name,k==="sorting_asc"?"asc":"desc");}},_formatCellValue:function(k,j){k=d.trim(k);if(k&&j.format!=undefined){if(d.isFunction(j.format)){return j.format.call(this,k,record,j,this);}if(d.type(j.format)==="string"){if(d.type(k)==="string"){var l=j.format.replace(/\d*/,"")||" ";var i=j.format.replace(l,"")||0;k=k.split(l)[parseInt(i)];}else{k=k.format(j.format);}}}return k;},_renderCell:function(n,l,k,j,o){var i=d("<td></td>");l=this._formatCellValue(l,k);i.html(k.render?k.render.call(this,l,j,o,i,k,this):l);if(k.style){i.css(k.style);}if(k.css){i.addClass(d.isFunction(k.css)?k.css.call(this,l,j,o,i,k,this):k.css);}var m=k.width?k.width:this.defaultColumnWidth;i.css({width:m});this.fire("cellrender",l,j,i,k,o);return i;},draw:function(){var j=this;this.tbody.children().remove();this.store.each(function(k,p){var m,n,o;o=d("<tr></tr>").appendTo(this.tbody);o.attr("rowIndex",p);for(var l=0;l<this.columns.length;l++){m=this.columns[l];n=k.data[m.field];if(m.rowCss){o.addClass(d.isFunction(m.rowCss)?m.rowCss.call(this,n,k,p,m,this):m.rowCss);}o.append(this._renderCell(o,n,m,k,p));}j.fire("rowrender",k,p,o);},this);for(var i in this.plugins){f(this,this.plugins[i],"fnUpdate");}this.fire("draw",this);var j=this;this.tbody.css({"height":this.table.height()-this.thead.height()});d(b).resize(function(){j.tbody.css({"height":j.table.height()-j.thead.height()});});this.tbody.scroll(function(k){j.thead.find("tr").css({left:-this.scrollLeft});});},getRecordAt:function(i){return this.store.at(i);},onSort:function(j,i){this.draw();var k=this.headers.filter("[data-field="+j+"]");this.headers.filter(".sorting, .sorting_asc, .sorting_desc").removeClass("sorting sorting_asc sorting_desc").not(k).addClass("sorting");k.addClass("sorting_"+i);}});g.setDefaults=function(i){d.extend(true,e,i);};g.utils={parseNumber:function(i){switch(typeof i){case"string":i=i.replace(/[A-Za-z\s]+/,"");if(d.isNumeric(i)){return new Number(i);}break;case"number":return i;break;}return 0;},apply:function(k,l,j){if(j){g.utils.apply(k,j);}if(k&&l&&typeof l=="object"){for(var i in l){k[i]=l[i];}}return k;}};g.extend=g.utils.apply;g.additives={};g.plugins={"oPagination":{"_sCss":"paginate","_sProp":"paginationType","_oOverrides":{"fnPageChange":function(i){this.page.page=g.utils.parseNumber(i);this.page.start=this.page.page*this.page.limit;this.store.load({params:{start:this.page.start,limit:this.page.limit}});}},"_fnInitBefore":function(){this.page={start:0,end:0,limit:this.settings.iPageLength||this.settings.lengthMenu[0]||30,total:0,display:0,page:0,pages:0};this.store.on("beforeload",function(i){this.page.start=i&&i.params&&i.params.start!=undefined&&i.params.start!=null?i.params.start:this.page.start;},this);},"_fnUpdateBefore":function(){this.page.start=this.page.start||0;this.page.end=this.page.start+this.store.totalRecords;this.page.total=this.store.total||0;this.page.display=this.store.totalRecords;this.page.page=Math.ceil(this.page.start/this.page.limit);this.page.pages=Math.ceil(this.page.total/this.page.limit);}},"oLengthMenu":{"_sCss":"length_menu","_sProp":"lengthMenuType","_oOverrides":{"fnLengthChange":function(i,j){this.page.limit=g.utils.parseNumber(i);if(j!==false){this.fnPageChange(0);}}}}};g.sorters={"string":function(j,i){j=new String(j);i=new String(i);if(j&&i){return j.localeCompare(i);}else{if(!j&&!i){return 0;}else{if(i){return -1;}}}return 1;},"number":function(j,i){j=new Number(j||0);i=new Number(i||0);return j-i==0?0:j-i>0?1:-1;}};g.ux={};g.ux.RowNumber=function(j,i){g.utils.apply(this,i,{width:j.settings.rnWidth||30,sortable:false,tip:false,style:{"text-align":"center","padding":"0 5px"},render:function(l,k,m){return m+1;}});};g.ux.SelectModel=function(j,k,i){g.utils.apply(this,{width:j.settings.cbWidth||30,sortable:false,tip:false,style:{"text-align":"center","padding":"0 5px"},header:'<input type="checkbox" class="hcbm"/>',render:function(m,l,n){return d.format('<input type="checkbox" class="cbm" rowIndex="{0}"/>',n);}});j.selectModel=this;j.on("allheadersrender",function(){j.thead.find("input.hcbm").click(function(){var l=d(this).prop("checked");j.tbody.find("tr").each(function(){j.selectModel.selectRow(d(this).attr("rowIndex"),l);});});},this);this.clearRow=function(l){if(l!==undefined&&l!=null){j.tbody.find("tr[rowIndex="+l+"]").removeClass("selected").find("input.cbm").prop("checked",false);}else{j.tbody.find("tr.selected").removeClass("selected").find("input.cbm").prop("checked",false);}};this.selectRow=function(q,n){var o=j.tbody.find("tr[rowIndex="+q+"]");var l=j.store.at(q);var m=o.hasClass("selected");var p=n===false?false:true;if(j.fire("beforeselect",l,p,o)===false){return;}if(o.hasClass("disabled")){o.removeClass("selected").find("input.cbm").prop("checked",false);return;}if(p!==m){if(p){if(k){j.tbody.find("tr.selected").removeClass("selected").find("input.cbm").prop("checked",false);}o.addClass("selected").find("input.cbm").prop("checked",true);}else{o.removeClass("selected").find("input.cbm").prop("checked",false);}}j.fire("rowselect",l,n,q);};this.getSelectRows=function(){var l=[];j.tbody.find("tr.selected").each(function(){l.push(j.store.at(d(this).attr("rowIndex")));});return l;};this.getSelectCount=function(){return j.tbody.find("tr.selected").length;};j.on("rowrender",function(l,n,m){m.click(function(o){if(j.settings.clickCheck!==false&&j.fire("rowclick",l,n,m,o)!==false){j.selectModel.selectRow(n);}});m.find("input.cbm").click(function(o){j.selectModel.selectRow(n,d(this).prop("checked"));j.fire("rowcheck",l,n,m,o);o.stopPropagation();});},j);};return g;})(jQuery,window);(function(d,b,a){var c=function(e){this.handlers=e||c.handlers;};b.extend(c.prototype,{parse:function(l,e,j){j=j||{};var k=[e];for(var h=0;h<l.length;h++){var f=l.charAt(h);var m=this.handlers[f];var g=k[k.length-1];var n=m.call(this.handlers,l,h,g,j,this);switch(n.action){case"begin":k.push(n.node);break;case"end":k.pop();break;}h=h+n.step;}}});c.handlers={"<":function(j,g,h,e,f){return{action:"begin",node:(e["<"]||b("<div></div>")).appendTo(h),step:0};},">":function(j,g,h,e,f){return{action:"end",step:0};},"t":function(j,g,h,e,f){return{action:"continue",node:(e["t"]||b("<table></table>")).appendTo(h),step:0};},"i":function(j,g,h,e,f){return{action:"continue",node:(e["i"]||b('<div class="xt-info"></div>')).appendTo(h),step:0};},"p":function(j,g,h,e,f){return{action:"continue",node:(e["p"]||b('<div class="paginate"></div>')).appendTo(h),step:0};},"l":function(j,g,h,e,f){return{action:"continue",node:(e["l"]||b('<div class="length_menu"></div>')).appendTo(h),step:0};},'"':function(l,j,k,g,h){var f=l.indexOf('"',j+1);var e=l.substring(j+1,f);if(f<0||f<j){throw"dom expr syntax error.";}this[e.charAt(0)](e,0,k);return{action:"continue",step:f-j};},"#":function(g,e,f){f.attr("id",g.substring(1));},".":function(g,e,f){f.addClass(g.substring(1));}};d.ux.DomExprParser=c;})(Xtable,jQuery,window);(function(d,c,b){var a=function(){this.events={};};c.extend(a.prototype,{fire:function(g){var f=this.events[g];if(f&&f.length>0){var h=Array.prototype.slice.call(arguments,1);for(var e=0;e<f.length;e++){if(f[e].fn.apply(f[e].scope||this,h.concat([f[e]]))===false){return false;}}}return true;},on:function(f,e,h){var g=Array.prototype.slice.call(arguments,3);this.events[f]=this.events[f]||[];this.events[f].push({type:f,fn:e,data:g,scope:h});},one:function(f,e){var h=e;var g=this;e=function(){g.off(f,e);return h.apply(this,arguments);};arguments[1]=e;this.on.apply(this,arguments);},off:function(h,g){var f=this.events[h];if(f&&f.length>0){for(var e=0;e<f.length;e++){if(f[e].fn==g){f.splice(e);return e;}}}return -1;},remove:function(e){this.events[e]=[];}});a.prototype.trigger=a.prototype.fire;a.initialize=function(g){a.call(g);var e=a.prototype;for(var f in e){g[f]=e[f];}};d.events=a;})(Xtable,jQuery,window);(function(c,b,a){c.plugins.oLengthMenu.select={"fnInit":function(f,j,e,h){var k=j.settings;var d=[];d.push('<select class="length_node length_select">');for(var g=0;g<k.lengthMenu.length;g++){d.push('<option value="');d.push(k.lengthMenu[g]);d.push('">');d.push(k.lengthMenu[g]);d.push("</option>");}d.push("</select>");f.append(d.join(""));if(k.iPageLength){f.find("select").val(k.iPageLength);}f.find("select").bind("change",{that:j},function(i){i.data.that.fnLengthChange.call(j,b(this).val(),this);});}};})(Xtable,jQuery,window);(function(e,b,a){function d(i,g,h,j,k){var f=[];f.push('<a href="javascript:void(0);" class="');f.push(h);if(j){f.push(" ");f.push(j);}if(g){f.push(" ");f.push(g);}f.push('" pageNumber="');f.push(i);f.push('">');f.push(k);f.push("</a>");return f.join("");}function c(v,o,u,m){var g=o.settings;var f=g.language.oPaginate;var j=g.oClasses;var s=o.page;var q=s.total;if(q<0){return;}var p=s.page+1;var i=s.pages;var n=g.iCounta||5;var t=parseInt(n/2);var h=p-t>1?p-t:1;var k=h+n-1>i?i:h+n-1;if(k==i){h=i-n>=1?i-n+1:1;}var l=[];l.push(d(1,p==1?"disabled":"active",j.sPageButton,j.sPageFirst,f.sFirst));l.push(d(p==1?1:p-1,p==1?"disabled":"active",j.sPageButton,j.sPagePrevious,f.sPrevious));l.push("<span>");for(var r=h;r<=k;r++){l.push(d(r,p==r?"current":"active",j.sPageButton,null,r));}l.push("</span>");l.push(d(p==i?i:p+1,p==i?"disabled":"active",j.sPageButton,j.sPageNext,f.sNext));l.push(d(i,p==i?"disabled":"active",j.sPageButton,j.sPageLast,f.sLast));v.children().remove();v.append(l.join(""));v.find("."+j.sPageButton).click(function(){var w=b(this);if(w.hasClass("disabled")||w.hasClass("current")){return;}o.fnPageChange(parseInt(w.attr("pageNumber"))-1);});}e.plugins.oPagination.half={"fnInit":c,"fnUpdate":c};})(Xtable,jQuery,window);(function(e,b,a){function d(i,g,h,j,k){var f=[];f.push("<li>");f.push('<a href="javascript:;" class="');f.push(h);if(j){f.push(" ");f.push(j);}if(g){f.push(" ");f.push(g);}f.push('" ');f.push('pageNumber="');f.push(i);f.push('" >');f.push(k);f.push("</a>");f.push("</li>");return f.join("");}function c(q,l,p,k){var g=l.settings;var f=g.language.oPaginate;var i=g.oClasses;var o=l.page;var n=o.total;if(n<0){return;}var m=o.page+1;var h=o.pages;m=m>h?h:m;var j=[];j.push("<ul>");j.push(d(1,m==1?"disabled":"active",i.sPageButton,i.sPageFirst,f.sFirst));j.push(d(m==1?1:m-1,m==1?"disabled":"active",i.sPageButton,i.sPagePrevious,f.sPrevious));j.push('<li><input type="text" value="');j.push(m);j.push('" class="input_page"/></li>');j.push(d(m==h?h:m+1,(m==h||h==0)?"disabled":"active",i.sPageButton,i.sPageNext,f.sNext));j.push(d(h,(m==h||h==0)?"disabled":"active",i.sPageButton,i.sPageLast,f.sLast));j.push("<li>当前页："+m+"</li>");j.push("<li>总页数："+h+"</li>");j.push("<li>总记录数："+n+"</li>");j.push("</ul>");q.children().remove();q.append(j.join(""));q.find("."+i.sPageButton).click(function(){var r=b(this);if(r.hasClass("disabled")||r.hasClass("current")){return;}l.fnPageChange(parseInt(r.attr("pageNumber"))-1);});q.find(".input_page").keydown(function(t){if(t.keyCode==13){var s=b(this);var r=parseInt(s.val()||"0");if(r>l.page.pages){r=l.page.pages;}if(r<=0){r=1;}l.fnPageChange(r-1);t.stopPropagation();t.preventDefault();}});}e.plugins.oPagination.input={"style":"paginate_input","fnInit":c,"fnUpdate":c};})(Xtable,jQuery,window);(function(c,b,a){c.setDefaults({tips:"tooltipster"});c.extend(c.additives,{"oTips":{"_sProp":"tips"}});c.additives.oTips.tooltipster={"fnInit":function(f,e,d){f.on("cellrender",function(k,h,g,i,l){var j=g.html();if(i.tip!==false&&j){g.tooltipster({content:j});}},f);}};})(Xtable,jQuery,window);(function(d,b,a){var c=function(e){d.events.initialize(this);this.settings=e;this.url=this.settings.url;this.fields=this.settings.fields;this.params={};this.baseParams={};this.page={};this.reader=d.utils.apply({},this.reader,{"total":"total","rows":"rows"});};b.extend(c.prototype,{load:function(e){if(this.fire("beforeload",e,this)===false){return;}this.params={};d.utils.apply(this.params,this.baseParams,e.params);this.fire("loading",e,this.params,this);if(this.url&&this.settings.remoteMode!==false){if(this.fire("beforeajax",this.params,this)===false){return;}this.loadAjax(this.url,this.params,function(f,g){this.handleResponse(f,g,e);});return;}this._loadData(e.data,e.params,e);},loadAjax:function(e,f,h){var g=this;b.ajax(d.utils.apply({},this.settings.ajaxOptions,{type:this.settings.method||"post",url:e,dataType:this.settings.dataType||"json",data:f,error:function(j,i,k){h.call(g,null,i?i:k.message);},success:function(i){h.call(g,i);}}));},handleResponse:function(g,h,f){this.fire("ajax",g,h);this._loadData(g,null,f);},each:function(g,f){for(var e=0;e<this.rows.length;e++){if(g.call(f||this.rows[e]||this,this.rows[e],e,this.rows)===false){return;}}},at:function(e){return this.rows[e];},fieldIndexOf:function(e){for(var f=0;f<this.fields.length;f++){if(this.fields[f].name===e){return f;}}return -1;},sort:function(f,h){var e=this.fieldIndexOf(f);var i=this.fields[e];var g=h==="asc"?1:-1;if(i){if(this.settings.remoteSort!==true){this.rows.sort(function(k,j){return d.sorters[i.type](k.data[i.name],j.data[i.name])*g;});this.fire("sort",f,h,this);return;}if(this.url){this.load({params:{"order":i.type,"asc":h},fnCallback:function(){this.fire("sort",i.sort||f,h,this);}});}}},_loadData:function(i,j,h){switch(b.type(i)){case"string":var l=b.parseJSON(i);if(!l){return;}this._loadData(l,h);return;break;case"function":var l=i.call(this,i);if(!l){return;}this._loadData(l,h);return;break;case"array":this.oRows=i;this.total=this.oRows.length;break;case"object":this.oRows=i[this.reader.rows]||[];this.total=i[this.reader.total]||this.oRows.length;break;default:this.oRows=this.oRows||[];this.total=this.oRows.length;break;}this.rows=[];var k=j?j.start||0:0;var f=j?j.limit||this.oRows.length:this.oRows.length;var g=0;for(var e=f+k>this.oRows.length?this.oRows.length:f+k;k<e;k++){this.rows.push({index:g++,data:this.oRows[k]});}this.totalRecords=this.rows.length;this.fire("load",this,this.totalRecords,this.rows,this.oData,h);if(b.isFunction(h.fnCallback)){h.fnCallback.call(this,this,this.totalRecords,this.rows,this.oData,h);}}});d.ux.Store=c;})(Xtable,jQuery,window);